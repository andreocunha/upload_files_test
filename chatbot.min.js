// ¬©2022 Andr√© Oliveira Cunha

const answersResult=[];const data=[{question:'Ol√°, tudo bem?<br><br>Vamos consultar o Pre√ßo para sua Cota√ß√£o em 5 min?',options:['Sim, quero receber','N√£o, obrigado'],type:'select',},{question:'Para isso preciso de algumas informa√ß√µes r√°pidas üôÇ<br><br>Qual √© o seu nome?',type:'input',},{question:'Prazer em te conhecer, ${answersResult[1]}!<br><br>Em qual e-mail corporativo gostaria de receber a proposta?',type:'input',},{question:'√ìtimo, ${answersResult[1]}!<br><br>Poderia me informar seu telefone ? (Prometo n√£o incomodarüôè)',type:'input',},{question:'Legal, estamos quase l√°...<br><br>De qual empresa voc√™ fala?',type:'input',},{question:'Qual sua principal necessidade?',options:['Aumentar as vendas','Aumentar a produtividade','Aumentar a efici√™ncia','Aumentar a satisfa√ß√£o dos clientes'],type:'select',},{question:'Por √∫ltimo, qual √© o n√∫mero de colaboradores de sua empresa?',options:['1 a 10','11 a 100','101 a 500','501 a 1000','Mais de 1000'],type:'select',},{question:'Obrigado! Em breve nossa equipe de consultores ir√° entrar em contato para apresentar a melhor proposta para sua empresa ü§ù',options:['Ok, obrigado!'],type:'select',},{question:'Resumo da sua cota√ß√£o:<br><br>Nome: ${answersResult[1]}<br>E-mail: ${answersResult[2]}<br>Telefone: ${answersResult[3]}<br>Empresa: ${answersResult[4]}<br>Necessidade: ${answersResult[5]}<br>Quantidade de colaboradores: ${answersResult[6]}<br><br>',options:['Enviar cota√ß√£o'],type:'select',}]
let content=null;let input=null;let inputArea=null;function createQuestion(question){const div=document.createElement('div');div.classList.add('question');if(question.question.includes('${answersResult[1]}')){question.question=question.question.replace('${answersResult[1]}',answersResult[1]);}if(question.question.includes('${answersResult[2]}')){question.question=question.question.replace('${answersResult[2]}',answersResult[2]);}if(question.question.includes('${answersResult[3]}')){question.question=question.question.replace('${answersResult[3]}',answersResult[3]);}if(question.question.includes('${answersResult[4]}')){question.question=question.question.replace('${answersResult[4]}',answersResult[4]);}if(question.question.includes('${answersResult[5]}')){question.question=question.question.replace('${answersResult[5]}',answersResult[5]);}if(question.question.includes('${answersResult[6]}')){question.question=question.question.replace('${answersResult[6]}',answersResult[6]);}
if(question.type==='input'){div.innerHTML=`
      <p>${question.question}</p>
      `;inputArea.style.display='flex';input.disabled=false;input.focus();input.addEventListener('keyup',getInputValue);}else{div.innerHTML=`
    <p>${question.question}</p>
    <div class="options">
      ${question.options.map(option => `<button
onclick="createAnswer('${option}');">${option}</button>`).join('')}
    </div>
  `;}
content.appendChild(div);}
function getInputValue(e){if((input.disabled==false)&&(e.keyCode===13||e.type==='click')){const value=input.value;input.value='';input.disabled=true;inputArea.style.display='none';createAnswer(value);}}
function createAnswer(answer){answersResult.push(answer);const div=document.createElement('div');div.classList.add('answer');div.innerHTML=`
    <p>${answer}</p>
  `;content.appendChild(div);animateTyping();scrollToBottom();}
function nextQuestion(){const questions=document.querySelectorAll('.question');const index=questions.length-1;if(index<data.length-1){createQuestion(data[index+1]);}}
function scrollToBottom(){content.scrollTop=content.scrollHeight;}
function animateTyping(){const div=document.createElement('div');div.classList.add('typing');div.innerHTML=`
  <lottie-player src="https://assets10.lottiefiles.com/packages/lf20_nZBVpi.json"  background="transparent"  speed="1.8"  style="width: 80px;" loop autoplay></lottie-player>
  `;content.appendChild(div);setTimeout(()=>{div.remove();nextQuestion();},3000);}
function startBot(){animateTyping();}
function createChatArea(){const div=document.createElement('div');div.innerHTML=`
  <lottie-player class="mascot" src="https://lottie.host/acdc7517-679e-4ddf-8f3f-5f4a17f3c715/nvxXKgDDfK.json" background="transparent" speed="0.8" style="width: 150px; height: 150px;" loop autoplay></lottie-player>
  <div class="container">
    <div class="header">
          <img src="https://res.cloudinary.com/dj1ereyp0/image/upload/v1666743604/Logos/Branca/SingleSVG_ju7nne.svg" alt="Avatar" class="avatar" width="40px" height="40px" />
          <div class="header-text">
              <h4>Moddev</h4>
              <p>Online agora</p>
          </div>
          <button onclick="closeModal()" class="header-close">
            x
          </button>
      </div>
      <div class="content" id="content"></div>
      <div class="input-area" id="input-area">
          <input class="input" id="input" disabled type="text" placeholder="Digite aqui..." />
          <div class="send" id="send"></div>
      </div>
  </div>
  `;document.body.appendChild(div);content=document.getElementById('content');input=document.getElementById('input');inputArea=document.getElementById('input-area');}
function closeModal(){console.log("clicou")
document.querySelector('.chat-icon').classList.remove('hide');document.querySelector('.container').classList.remove('active');document.querySelector('.mascot').classList.remove('active');}
function createIcon(){const div=document.createElement('div');div.innerHTML=`
  <div class="chat-icon">
    <img src="https://res.cloudinary.com/dj1ereyp0/image/upload/v1666743604/Logos/Branca/SingleSVG_ju7nne.svg" alt="Avatar" class="avatar" width="35px" height="35px" />
  </div>
  `;document.body.appendChild(div);div.addEventListener('click',()=>{document.querySelector('.container').classList.add('active');document.querySelector('.chat-icon').classList.add('hide');document.querySelector('.mascot').classList.add('active');if(content.innerHTML===''){startBot();}});}
window.addEventListener('load',()=>{const script=document.createElement('script');script.src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js";script.async=true;document.body.appendChild(script);const style=document.createElement('link');style.rel="stylesheet";style.href="./styles.css";document.body.appendChild(style);createChatArea();createIcon();});